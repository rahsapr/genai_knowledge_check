<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Who Wants to Be an AI Millionaire</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700;900&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
/* -------------------- THEME & LAYOUT -------------------- */
:root{
  --bg:#07102a;
  --panel:#0f2147;
  --accent1:#ffb84d; /* Gold */
  --accent2:#ff7a59; /* Coral */
  --neon:#7c5cff;    /* Purple */
  --text:#e6eef8;
  --muted:#9fb0cd;
  --success:#26c281;
  --danger:#ff6b6b;
  --glass: rgba(255,255,255,0.02);
  --border-light: rgba(255,255,255,0.03);
  --border-medium: rgba(255,255,255,0.06);
  --shadow-color: rgba(2,6,18,0.7);
}
*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  background:
    radial-gradient(900px 400px at 10% 12%, rgba(124,92,255,0.06), transparent 10%),
    radial-gradient(900px 350px at 90% 90%, rgba(255,122,89,0.02), transparent 10%),
    var(--bg);
  font-family:'Montserrat',system-ui,-apple-system,'Segoe UI',Roboto,Arial;
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  padding:18px;
}
* { transition: all .2s ease-out; }

/* app layout */
.app{
  max-width:1220px;
  margin:6px auto;
  display:grid;
  grid-template-columns: 1fr 340px;
  gap:18px;
}
@media (max-width:1000px){ .app{ grid-template-columns:1fr; padding:12px } }

.panel {
  border-radius:14px;
  padding:20px;
  background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
  border:1px solid var(--border-light);
  box-shadow: 0 12px 40px var(--shadow-color);
}

/* main pane */
.main{ min-height:620px; display:flex; flex-direction:column; gap:18px; }

/* ladder pane */
.ladder{ min-height:620px; padding:20px; background: linear-gradient(180deg, rgba(13,25,60,0.6), rgba(6,12,30,0.45)); color:var(--muted); border-radius:14px; border:1px solid var(--border-light); box-shadow:0 12px 40px rgba(2,6,18,0.6); }

/* --- START SCREEN --- */
.start-screen{ 
  display:flex; 
  flex-direction:column; 
  gap:16px; 
  align-items:center; 
  justify-content:center; 
  flex-grow: 1; 
  text-align:center; 
  padding:0; 
  cursor: pointer; 
  position: relative; /* Needed to position the button inside */
}
#startScreenImg { max-width: 100%; height: auto; border-radius: 12px; }
#startScreenImg:hover { transform: scale(1.02); box-shadow: 0 15px 40px var(--shadow-color); }

/* --- Buttons on Start Screen --- */
#playGameBtn {
  position: absolute;
  bottom: 25px;
  left: 25px;
  background: linear-gradient(45deg, var(--neon), var(--accent2));
  color: #fff;
  font-weight: 900;
  padding: 10px 20px;
  border-radius: 12px;
  border: 3px solid #1c1c1c;
  box-shadow: 4px 4px 0 #1c1c1c;
  text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
  font-size: 14px;
  z-index: 5;
  cursor: pointer;
}
#playGameBtn:hover {
  transform: scale(1.05) rotate(2deg);
  box-shadow: 6px 6px 0 #1c1c1c;
}

#howToPlayBtn {
  position: absolute;
  bottom: 25px;
  right: 25px;
  background: linear-gradient(45deg, #ff7a59, #ffb84d);
  color: #fff;
  font-weight: 900;
  padding: 10px 20px;
  border-radius: 12px;
  border: 3px solid #1c1c1c;
  box-shadow: 4px 4px 0 #1c1c1c;
  text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
  font-size: 14px;
  z-index: 5;
  cursor: pointer;
}
#howToPlayBtn:hover {
  transform: scale(1.05) rotate(-2deg);
  box-shadow: 6px 6px 0 #1c1c1c;
}


/* buttons */
.btn{ padding:12px 24px; border-radius:10px; border:none; cursor:pointer; font-weight:800; letter-spacing:0.3px; font-size: 15px; }
.btn-start{ background: linear-gradient(90deg,var(--neon),var(--accent2)); color:#041027; box-shadow: 0 8px 20px rgba(124, 92, 255, 0.2); }
.btn-start:hover{ transform: translateY(-3px); box-shadow: 0 12px 25px rgba(255, 122, 89, 0.25); }
.btn-ghost{ background:transparent; border:1px solid var(--border-medium); color:var(--text); }
.btn-ghost:hover{ background: var(--glass); border-color: rgba(255,255,255,0.15); }

/* topbar - lifelines and timer */
.topbar{ display:flex; align-items:flex-start; justify-content:space-between; gap:12px }

/* --- LIFELINE STYLES --- */
.lifelines-container { display: flex; flex-direction: column; gap: 8px; }
.lifelines-label { color: var(--muted); font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; padding-left: 2px; opacity: 0.6; }
.lifelines{ display:flex; gap:10px; align-items:center; }
.lifeline-btn{
  background: #fff;
  padding:8px; border-radius:10px; width:52px; height:48px; display:flex; align-items:center; justify-content:center;
  cursor:pointer; border: none; position:relative;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
#btnAlexa {
  width: 100px; /* Make the Alexa button wider to fit the logo */
}
.lifeline-btn img {
  width: 100%;
  height: 100%;
  object-fit: contain; /* This ensures the image scales down correctly */
}
.lifeline-btn:hover{ transform:translateY(-3px); box-shadow: 0 8px 20px rgba(2,6,18,0.8); }
.lifeline-btn.used{ opacity:0.5; pointer-events:none; transform:none; box-shadow: none; }
.lifeline-btn.used img { filter: grayscale(1); }
#muteToggle { font-size: 20px; margin-top: 29px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06)); border: 1px solid var(--border-light); }

/* tooltip on hover */
.lifeline-btn .tooltip{
  position:absolute; top:calc(100% + 8px); left:50%; transform:translateX(-50%); background:rgba(8,12,28,0.98); color:var(--muted);
  padding:8px 12px; border-radius:8px; font-size:13px; white-space:nowrap; display:none; box-shadow:0 8px 30px rgba(0,0,0,0.6); z-index: 10;
}
.lifeline-btn:hover .tooltip{ display:block }

/* timer */
.timer{ margin-top: 29px; /* Align with other buttons */ padding:10px 18px; border-radius:10px; font-weight:900; font-size:22px; min-width:90px; text-align:center; background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.06)); border:1px solid var(--border-light); box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
.timer.warning{ box-shadow:0 0 12px 2px rgba(255,160,80,0.2); color:var(--accent2); border-color: rgba(255,160,80,0.2); }
.timer.danger{ box-shadow:0 0 15px 3px rgba(255,90,90,0.25); color:var(--danger); border-color: rgba(255,90,90,0.25); animation: pulse-danger .8s infinite; }
@keyframes pulse-danger { 50% { transform: scale(1.05); } }

/* question card */
.question-card{ background: linear-gradient(180deg, rgba(10,20,40,0.92), rgba(6,12,30,0.92)); border-radius:12px; padding:24px; border:1px solid var(--border-medium); flex-grow: 1; display:flex; flex-direction:column; gap:14px }
.q-meta{ display:flex; justify-content:space-between; align-items:flex-start; gap:10px; }
.q-meta .left{ font-size:14px; color:var(--muted); }
.q-meta .prize{ font-weight:900; color:var(--accent1); font-size:20px; }

/* question text */
.question{ font-size:clamp(18px, 2.5vw, 22px); font-weight:700; line-height:1.4; color:var(--text); margin:auto 0; white-space:normal; word-break:break-word; text-align: center; padding: 10px 0; }

/* answers */
.answers{ display:grid; grid-template-columns:1fr 1fr; gap:14px; align-items:stretch; margin-top:auto; }
.answer{ background: linear-gradient(90deg,#26366f,#1b274f); padding:14px; border-radius:12px; border:1px solid var(--border-medium); display:flex; gap:12px; align-items:center; cursor:pointer; color:var(--text); min-height:72px; box-shadow:0 6px 18px rgba(2,8,20,0.6); position: relative; }
.answer .label{ min-width:44px; height:44px; line-height:44px; text-align:center; border-radius:10px; font-weight:900; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12)); color:var(--muted); flex-shrink:0 }
.answer .text{ font-weight:700; font-size:clamp(14px, 2vw, 16px); color:var(--text); line-height:1.3; white-space:normal }
.answer:hover{ transform:translateY(-6px); box-shadow:0 12px 30px rgba(2,8,20,0.8), 0 0 15px rgba(255,184,77,0.15); border-color: rgba(255,200,120,0.2); }
.answer.disabled{ opacity:0.32; pointer-events:none; transform:none; box-shadow:none }
.answer.correct{
    border-color: rgba(38,194,129,0.4);
    background: linear-gradient(90deg, #1A4A3A, #10322A);
    box-shadow: 0 0 20px rgba(38,194,129,0.3);
    animation: pulse-correct .5s;
}
.answer.correct .label { background: var(--success); color: var(--bg); }
@keyframes pulse-correct { 50% { transform: scale(1.03); } }

.answer.wrong{
    border-color: rgba(255,107,107,0.4);
    background: linear-gradient(90deg, #5A2A2A, #421a1a);
    box-shadow: 0 0 20px rgba(255,107,107,0.25);
}
.answer.wrong .label { background: var(--danger); color: var(--bg); }

/* controls */
.controls{ display:flex; justify-content:space-between; align-items:center; margin-top:12px; gap:12px }
.hint{ color:var(--muted); font-size:14px }
.walk{ background:linear-gradient(90deg,#53607f,#384a6b); color:var(--text); padding:12px 18px; border-radius:12px; font-weight:800; border:1px solid var(--border-light); cursor: pointer; }
.walk:hover { background:linear-gradient(90deg,#69789a,#475c80); transform: translateY(-2px); box-shadow: 0 6px 15px rgba(2,6,18,0.8); }

/* ladder */
.ladder h3{ margin:0 0 8px 0; color:var(--text); font-size:22px; font-weight: 700; }
.ladder small{ color:var(--muted); display:block; margin-bottom:12px; }
.prize-list{ display:flex; flex-direction:column; gap:8px; max-height:640px; overflow:auto; padding-right:6px; }
.prize{ display:flex; justify-content:space-between; align-items:center; padding:10px 14px; border-radius:8px; background:transparent; color:var(--muted); font-weight:700; border:1px solid var(--border-light); }
.prize.current{ background: linear-gradient(90deg,var(--accent1),var(--accent2)); color:#041027; box-shadow:0 10px 30px rgba(255,122,89,0.25); transform:translateX(8px); border-color: transparent; }
.prize.guaranteed{ border-color: rgba(255,184,77,0.3); box-shadow: inset 0 0 8px rgba(255,184,77,0.1); }
.prize.guaranteed div:first-child { color: var(--accent1); }

/* modals & overlays */
.modal-backdrop{ position:fixed; inset:0; background: rgba(4,8,20,0.8); backdrop-filter: blur(4px); display:flex; align-items:center; justify-content:center; z-index:60; }
.modal{ background: linear-gradient(180deg, #142a55, #0c1a3a); padding:24px; border-radius:14px; width:640px; max-width:94%; color:var(--text); border:1px solid var(--border-medium); box-shadow: 0 15px 50px rgba(0,0,0,0.5); }
.modal h3 { margin-top: 0; color: var(--accent1); font-family: 'Playfair Display'; font-size: 24px;}
.modal p { color: var(--muted); line-height: 1.6; }

/* final-answer overlay */
.final-overlay{
  position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:120;
  background: linear-gradient(180deg, rgba(2,6,18,0.7), rgba(2,6,18,0.9));
  backdrop-filter: blur(5px);
}
.final-card{
  background:linear-gradient(180deg, #142a55, #0c1a3a); padding:24px; border-radius:14px;
  width:420px; max-width:92%; text-align:center; border:1px solid var(--border-medium);
  box-shadow: 0 15px 50px rgba(0,0,0,0.5);
}
#finalPrompt { font-family: 'Playfair Display'; font-size: 28px; margin-bottom: 8px; color: var(--accent1); }
#finalChoice { color: var(--muted); margin-bottom: 20px; font-size: 16px; }
#finalChoice strong { color: var(--text); font-size: 18px; }

/* celebration confetti (simple) */
.confetti { position:fixed; pointer-events:none; width:100%; height:100%; left:0; top:0; z-index:110; }
.piece{ position:absolute; width:10px; height:16px; border-radius:2px; opacity:0; animation: fall 1100ms linear forwards; }
@keyframes fall {
  0%{ opacity:1; transform:translateY(-40px) rotate(0deg) }
  100%{ opacity:1; transform:translateY(520px) rotate(720deg) }
}

/* end screen */
.end-screen{ display:flex; flex-direction:column; align-items:center; justify-content:center; gap:12px; padding:24px 0; text-align:center; }
.end-title{ font-family:'Playfair Display'; font-size:42px; color:var(--accent1); margin:0; }
.end-screen > .muted { margin-bottom: 12px; }
#endPrize { font-size: 24px; font-weight: 700; color: var(--text); }
#nameEntrySection { width: 100%; max-width: 480px; }
#nameEntrySection input {
  padding:12px 16px; border-radius:8px; border:1px solid var(--border-medium);
  background:rgba(0,0,0,0.2); color:var(--text); min-width: 260px;
  font-size: 15px; text-align: center; flex-grow: 1;
}
#nameEntrySection input:focus { border-color: var(--neon); outline: none; box-shadow: 0 0 10px rgba(124, 92, 255, 0.2); }
#saveScoreBtn { background: linear-gradient(90deg,var(--accent1),#ffd27a); color:#04101a; }
#postSaveControls { display: flex; gap: 12px; align-items: center; margin-top: 24px; }

/* leaderboard table */
.leaderboard-section {
  width:100%; max-width:720px; margin-top:24px; text-align:left;
  background: rgba(0,0,0,0.1); padding: 16px; border-radius: 12px;
  border: 1px solid var(--border-light);
}
.leaderboard-section h4 { margin: 0 0 12px 0; color:var(--muted); font-size: 18px; text-align: center; }
.leaderboard{ margin-top:12px; width:100%; max-width:720px; color:var(--muted); }
.lb-row{ display:flex; justify-content:space-between; gap:12px; padding:10px 12px; border-radius:8px; background:rgba(255,255,255,0.018); margin-bottom:6px; font-weight:700; border-bottom: 1px solid var(--border-light); }
.lb-row:last-child { border-bottom: none; }
.lb-row div:first-child { color: var(--text); }

/* subtle animations */
.fade-in{ animation:fadeIn .45s ease-out both; }
@keyframes fadeIn{ from{opacity:0; transform:translateY(8px)} to{opacity:1; transform:none} }

/* -------------------- RETRO CERTIFICATE STYLES -------------------- */
#retroCertificate {
  display: none; /* Hidden by default */
  width: 100%;
  max-width: 800px;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  padding: 30px;
  border-radius: 12px;
  border: 4px solid #ffdf00;
  text-align: center;
  font-family: 'Press Start 2P', cursive;
  position: relative;
  overflow: hidden;
  margin-top: 24px;
  box-shadow: 0 0 40px rgba(255, 223, 0, 0.2);
  text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
}
#retroCertificate::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0) 100%);
    transform: rotate(25deg);
    animation: shine-sweep 4s infinite;
}
@keyframes shine-sweep {
    0% { transform: translateX(-75%) rotate(25deg); }
    100% { transform: translateX(75%) rotate(25deg); }
}
#retroCertificate h2 {
  font-size: clamp(16px, 4vw, 24px);
  margin: 10px 0 20px 0;
  color: #ffdf00;
  line-height: 1.2;
}
#retroCertificate h3 {
  font-size: clamp(18px, 5vw, 32px);
  margin: 10px 0;
  color: #33ffdd;
}
#retroCertificate p {
  margin: 15px 0;
  color: #efefef;
  font-size: clamp(10px, 2.5vw, 12px);
  line-height: 1.5;
}
.cert-badge {
  position: absolute;
  right: 20px;
  bottom: 20px;
  width: 100px;
  height: 100px;
  background: conic-gradient(from 0deg, #ff00ff, #00ffff, #ffff00, #ff00ff);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: black;
  font-size: 10px;
  font-weight: bold;
  text-align: center;
  line-height: 1.2;
  padding: 4px;
  text-shadow: none;
  animation: holographic-spin 3s infinite linear;
}
@keyframes holographic-spin {
  0% { filter: hue-rotate(0deg); }
  100% { filter: hue-rotate(360deg); }
}


/* -------------------- GRAND PRIZE CELEBRATION STYLES -------------------- */
#winOverlay {
  position: fixed;
  inset: 0;
  background: #000;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  z-index: 200;
}
#winOverlay img {
  width: 100%;
  height: 100%;
  object-fit: cover; /* This makes the GIF cover the screen without distortion */
}


/* --- PAGE FOOTER STYLES --- */
.page-footer {
  width: 100%;
  max-width: 1220px;
  margin: 24px auto 0;
  padding: 12px;
  text-align: center;
  font-size: 13px;
  color: var(--muted);
  opacity: 0.8;
}
.page-footer a {
  color: var(--accent1);
  font-weight: 700;
  text-decoration: none;
}
.page-footer a:hover {
  text-decoration: underline;
}

</style>
</head>
<body>
  <div class="app">
    <div class="panel main" id="mainPanel">

      <div id="startScreen" class="start-screen fade-in">
        <img id="startScreenImg" src="images/start-screen.png" alt="Who Wants to be a Gen-AI Millionaire - Play" title="Play Game">
        <button id="playGameBtn">Play Game</button>
        <button id="howToPlayBtn">How to Play</button>
      </div>

      <div id="gameArea" style="display:none; flex-direction: column; flex-grow: 1;">
        <div class="topbar">
          <div class="lifelines-container">
            <div class="lifelines-label">LIFELINES</div>
            <div class="lifelines" id="lifelineBar">
              <button class="lifeline-btn" id="btn5050" data-key="5050" aria-label="50:50">
                <img src="images/lifeline-5050.png" alt="50:50 Icon">
                <div class="tooltip">50:50 — Remove two incorrect answers</div>
              </button>
              <button class="lifeline-btn" id="btnAlexa" data-key="alexa" aria-label="Ask Alexa">
                <img src="images/lifeline-alexa.png" alt="Ask Alexa Icon">
                <div class="tooltip">Ask Alexa</div>
              </button>
              <button class="lifeline-btn" id="btnFlip" data-key="flip" aria-label="Flip the Question">
                <img src="images/lifeline-flip.png" alt="Flip Question Icon">
                <div class="tooltip">Flip the Question</div>
              </button>
            </div>
          </div>
          <div style="display:flex;align-items:center;gap:10px">
            <div id="muteToggle" class="lifeline-btn" title="Toggle sound">🔊</div>
            <div id="timer" class="timer">30s</div>
          </div>
        </div>
        <div class="question-card" id="questionCard">
          <div class="q-meta">
            <div class="left">Question <span id="qIndex">1</span> of 13</div>
            <div class="prize" id="currentPrize">$100</div>
          </div>
          <div class="question" id="questionText">Loading question...</div>
          <div class="answers" id="answers"></div>
        </div>
        <div class="controls">
          <div class="hint">Select an answer to confirm.</div>
          <div><button id="walkAwayBtn" class="walk">Walk Away</button></div>
        </div>
      </div>

      <div id="finalOverlay" style="display:none" class="final-overlay">
        <div class="final-card fade-in">
          <div id="finalPrompt">Final answer?</div>
          <div id="finalChoice">You selected: <strong>A</strong></div>
          <div style="display:flex;gap:8px;justify-content:center">
            <button id="finalCancel" class="btn btn-ghost">Cancel</button>
            <button id="finalConfirm" class="btn btn-start">Confirm Answer</button>
          </div>
        </div>
      </div>

      <div id="confetti" class="confetti" aria-hidden="true"></div>
      <div id="winContainer" aria-hidden="true"></div>

      <div id="modalRoot" style="display:none"></div>

      <div id="endScreen" style="display:none" class="end-screen">
        <h2 class="end-title" id="endTitle">Game Over</h2>
        <p class="muted">You won <strong id="endPrize">$0</strong></p>
        <div id="nameEntrySection" style="display:flex;gap:10px;align-items:center; margin-top: 12px;">
          <input id="playerName" placeholder="Enter name for certificate" />
          <button id="saveScoreBtn" class="btn btn-start">Save & See Certificate</button>
        </div>
        <div id="retroCertificate">
          <h2 id="certTitle">🏆 GenAI Wizard Award 🏆</h2>
          <p>This certifies that</p>
          <h3 id="certName">Player</h3>
          <p>Has achieved AI Mastery with winnings of</p>
          <h3 id="certAmount">$1,000,000</h3>
          <p>Date: <span id="certDate"></span></p>
          <div class="cert-badge">GenAI<br/>Knowledge<br/>Series</div>
        </div>
        <div id="postSaveControls" style="display:none; gap:10px;align-items:center; margin-top: 24px;">
          <button id="certBtn" class="btn btn-ghost">Get PNG Certificate</button>
          <button id="playAgainBtn" class="btn btn-ghost">Play Again</button>
        </div>
        <div id="leaderboardSection" class="leaderboard-section" style="display:none;">
          <h4 style="color:var(--muted)">Leaderboard (Top 5)</h4>
          <div id="leaderboard" class="leaderboard"></div>
        </div>
      </div>
    </div>

    <aside class="ladder panel">
      <h3>Prize Ladder</h3>
      <small>Guaranteed at Q5 and Q10</small>
      <div class="prize-list" id="prizeList"></div>
    </aside>
  </div>

  <footer class="page-footer">
    Built to help friends stay curious about GenAI. A project by <a href="https://www.linkedin.com/in/rahulsapru444/" target="_blank" rel="noopener noreferrer">Rahul Sapru</a>
  </footer>

  <audio id="sndStart" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
  <audio id="sndSuspense" loop src="https://actions.google.com/sounds/v1/ambiences/medium_crowd_cheer.ogg"></audio>
  <audio id="sndFinal" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
  <audio id="sndCorrect" src="https://actions.google.com/sounds/v1/cartoon/clang.ogg"></audio>
  <audio id="sndWrong" src="https://actions.google.com/sounds/v1/alarms/digital_watch_alarm_long.ogg"></audio>
  <audio id="sndLifeline" src="https://actions.google.com/sounds/v1/cartoon/slide_whistle.ogg"></audio>
  <audio id="sndMilestone" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
  <audio id="sndCelebrate" src="https://actions.google.com/sounds/v1/alarms/medium_bell_ring.ogg"></audio>
  <audio id="sndCrowd" loop src="https://actions.google.com/sounds/v1/ambiences/large_crowd_cheer_med.ogg"></audio>

<script>
/* -------------------- GAME DATA -------------------- */
const PRIZES = [
  {tier:13,label:"$1,000,000"}, {tier:12,label:"$125,000"}, {tier:11,label:"$64,000"},
  {tier:10,label:"$32,000",guaranteed:true}, {tier:9,label:"$16,000"}, {tier:8,label:"$8,000"},
  {tier:7,label:"$4,000"}, {tier:6,label:"$2,000"}, {tier:5,label:"$1,000",guaranteed:true},
  {tier:4,label:"$500"}, {tier:3,label:"$300"}, {tier:2,label:"$200"}, {tier:1,label:"$100"}
];

const AMAZON_QUESTIONS = [
    {q:"What is Amazon Bedrock's primary function?", choices:["A serverless database","A service to build with foundation models","A cloud-based IDE","A data streaming service"], a:1, difficulty:1},
    {q:"Amazon's own family of foundation models, available in Bedrock, is named what?", choices:["Olympus","Aurora","Titan","Meridian"], a:2, difficulty:1},
    {q:"Which AWS service is an AI-powered coding companion, similar to GitHub Copilot?", choices:["CodeCatalyst","Cloud9","CodeWhisperer","CodeDeploy"], a:2, difficulty:1},
    {q:"What is Amazon's conversational AI assistant for businesses, designed to be an 'expert on your business'?", choices:["Alexa for Business","Amazon Expert","Amazon Q","AWS Concierge"], a:2, difficulty:1},
    {q:"AWS's custom-designed chip for high-performance AI model *training* is called:", choices:["Graviton","Inferentia","Trainium","Anapurna"], a:2, difficulty:2},
    {q:"AWS's custom-designed chip optimized for cost-effective AI model *inference* is called:", choices:["Inferentia","Trainium","Graviton","QuantumLeap"], a:0, difficulty:2},
    {q:"In 2023-2024, Amazon made a multi-billion dollar investment in which major AI startup, making their models available on Bedrock?", choices:["OpenAI","Cohere","Mistral AI","Anthropic"], a:3, difficulty:2},
    {q:"Within Amazon Bedrock, what feature allows you to orchestrate tasks by giving the model access to tools and APIs?", choices:["Knowledge Bases","Provisioned Throughput","Agents","Guardrails"], a:2, difficulty:3},
    {q:"What AWS service is a fully managed platform to build, train, and deploy machine learning models at scale?", choices:["Amazon Rekognition","AWS Lambda","Amazon SageMaker","Amazon Polly"], a:2, difficulty:1},
    {q:"What is the primary purpose of 'Knowledge Bases for Amazon Bedrock'?", choices:["To fine-tune a model's weights","To implement Retrieval-Augmented Generation (RAG)","To store user conversations","To cache model responses"], a:1, difficulty:2},
    {q:"Amazon's Titan Image Generator model includes what built-in responsible AI feature by default?", choices:["Content filtering","Bias detection","Invisible watermarks","Redaction of faces"], a:2, difficulty:3},
    {q:"Amazon often describes its generative AI strategy in 'three layers'. What do these layers represent?", choices:["Small, Medium, Large models","Text, Image, Audio models","Infrastructure, Tools/FMs, Applications","Internal, Partner, Open-Source models"], a:2, difficulty:3},
    {q:"The Claude 3 family of models (Haiku, Sonnet, Opus) from Anthropic are prominently featured on which AWS service?", choices:["Amazon SageMaker","EC2 P5 Instances","Amazon Bedrock","AWS AI Platform"], a:2, difficulty:2},
    {q:"Which AWS service uses AI to automatically extract text and data from scanned documents?", choices:["Amazon Textract","AWS Comprehend","Amazon S3 Select","AWS Glue"], a:0, difficulty:1},
    {q:"If you wanted to turn text into lifelike speech using an AI service on AWS, which would you use?", choices:["Amazon Transcribe","Amazon Lex","Amazon Polly","Amazon Speechify"], a:2, difficulty:1},
    {q:"What feature in SageMaker provides access to a broad selection of pre-trained models, including many open-source foundation models?", choices:["SageMaker Studio","SageMaker Pipelines","SageMaker Canvas","SageMaker JumpStart"], a:3, difficulty:2},
    {q:"When using Amazon Q, what allows it to connect to your company's specific data sources like S3, Slack, or Salesforce?", choices:["IAM Roles","VPC Endpoints","Connectors","DataSync"], a:2, difficulty:2},
    {q:"AWS's AI-powered service for identifying objects, people, text, and activities in images and videos is called:", choices:["Amazon Lookout","Amazon Rekognition","AWS Panorama","Amazon Inspector"], a:1, difficulty:1}
];

let QUESTION_BANK = [
// --- NEW, HIGH-QUALITY QUESTIONS ---
{q:"What is the key difference between AWS Trainium and Inferentia chips?", choices:["Trainium uses ARM; Inferentia uses x86 architecture.","Trainium is for model training; Inferentia is for inference.","Trainium is for text; Inferentia is for images.","Trainium is high-cost; Inferentia is low-cost."], a:1, difficulty:2},
{q:"In a Mixture-of-Experts (MoE) model, what does the 'gating network' do?", choices:["Aggregates the final outputs from all experts.","Applies the final activation function to the output.","Routes each input token to the best expert.","Loads all model parameters into memory."], a:2, difficulty:3},
{q:"What's the main trade-off between a long context window and RAG?", choices:["Long context is open-source; RAG is proprietary.","RAG is for creativity; long context for facts.","RAG has fresh data; long context reasons over provided text.","Long context is more secure; RAG is vulnerable."], a:2, difficulty:2},
{q:"What is the primary advantage of State Space Models (SSMs) like Mamba?", choices:["They require much less training data.","They avoid quadratic complexity, scaling linearly.","They are inherently multimodal from the start.","They use fewer parameters for easier fine-tuning."], a:1, difficulty:3},
{q:"What do 'Action Groups' do in an Amazon Bedrock Agent?", choices:["Define the agent's personality and tone.","Group related APIs and functions the agent can use.","Filter for harmful or inappropriate content.","Manage the agent's conversation history."], a:1, difficulty:2},
{q:"What is the main reason for using synthetic data in AI training?", choices:["It downloads faster than real-world data.","To create large, diverse, and privacy-safe datasets.","To ensure the model only trains on text.","To completely eliminate the need for data labeling."], a:1, difficulty:2},
{q:"What is the goal of post-training quantization for LLMs on edge devices?", choices:["To increase the model's factual accuracy.","To teach the model a new skill post-training.","To reduce model size and speed up inference.","To add a layer of encryption to the model."], a:2, difficulty:2},
{q:"The ReAct framework for AI agents combines what two capabilities?", choices:["Creativity and factual recall.","Language understanding and generation.","Reasoning (thought) and taking actions (tools).","User input and output formatting."], a:2, difficulty:2},
{q:"What problem do multi-agent frameworks like AutoGen solve?", choices:["Reducing the computational cost of a single agent.","Enabling specialized agents to collaborate on complex problems.","Creating a universal communication protocol for all AIs.","Allowing AI agents to run completely offline."], a:1, difficulty:3},
{q:"Why use 'Provisioned Throughput' for a model in Amazon Bedrock?", choices:["To get early access to experimental models.","To get a lower, variable price per token.","To guarantee consistent performance and throughput.","To allow the model to be fine-tuned."], a:2, difficulty:2},
{q:"What is the core principle of Constitutional AI?", choices:["The model is trained only with direct human feedback.","The model critiques its own responses based on principles.","The model's training data is heavily filtered.","The model has hard-coded rules against specific topics."], a:1, difficulty:3},
{q:"Why is the 'Needle in a Haystack' test important for LLMs?", choices:["It tests the model's creative writing ability.","It measures the model's raw processing speed.","It assesses recall of a fact in a long document.","It evaluates the model's resistance to attacks."], a:2, difficulty:2},
{q:"What is a key focus for Amazon Q in enterprise settings?", choices:["Generating marketing and social media copy.","Automating multi-step business workflows.","Creating realistic 3D models and environments.","Composing original musical scores."], a:1, difficulty:2},
{q:"What is the main purpose of digital watermarking in AI-generated images?", choices:["To increase the visual quality of the image.","To make AI-generated content identifiable as synthetic.","To embed copyright information to prevent theft.","To reduce the image's file size."], a:1, difficulty:2},
{q:"What is the main goal of speculative decoding for LLM inference?", choices:["Using a 'draft' model to accelerate a larger one.","Caching common user queries for instant answers.","Predicting the user's next question in advance.","Running multiple models and having them vote."], a:0, difficulty:3},
{q:"What is a key step towards reliable 'tool use' in AI agents?", choices:["The ability to generate human-like conversation.","The ability to correctly understand and use APIs.","The ability to browse the entire internet.","The ability to run on low-power mobile devices."], a:1, difficulty:2},
{q:"What distinguishes 'Graph RAG' from traditional vector-based RAG?", choices:["Graph RAG is much faster but less accurate.","Graph RAG only works with image data.","Graph RAG uses relationships in a knowledge graph.","Graph RAG does not require a vector database."], a:2, difficulty:3},
{q:"What is the main purpose of 'Guardrails for Amazon Bedrock'?", choices:["To route requests to the cheapest available model.","To define and enforce safety and topic policies.","To protect the model from denial-of-service attacks.","To automatically translate the model's output."], a:1, difficulty:2},
{q:"What is the primary advantage of using a Small Language Model (SLM)?", choices:["They are more creative than large models.","Lower cost, faster performance, and high accuracy on niche tasks.","They are inherently more secure than large models.","They do not require any training data."], a:1, difficulty:2},
{q:"Combining Bedrock Agents with AWS Step Functions helps with what?", choices:["Automatically fine-tuning the foundation model.","Providing a serverless environment for code execution.","Visualizing the agent's internal thought process.","Orchestrating complex, long-running, and stateful tasks."], a:3, difficulty:3},
{q:"What is the main technical challenge for true multimodal AI?", choices:["The lack of sufficient video and audio data.","Finding a common representation space for all modalities.","The high cost of GPUs for processing video.","The slow speed of internet connections."], a:1, difficulty:3},

// --- GENERAL AI QUESTIONS ---
{q:"What is the primary goal of Context Engineering in GenAI?", choices:["To reduce the computational cost of AI models.","To strategically populate an AI model's context window with relevant information.","To develop new AI model architectures.","To improve the speed of AI model training."], a:1, difficulty:2},
{q:"Which of the following is a key benefit of effective Context Engineering?", choices:["Decreased model accuracy.","Increased irrelevant data processing.","Optimized AI agent performance.","Reduced need for data pre-processing."], a:2, difficulty:2},
{q:"Context Engineering is described as the discipline of designing and managing what?", choices:["AI model parameters.","Hardware infrastructure for AI.","Structures, signals, and affordances that modulate cognition and behavior.","User interfaces for AI applications."], a:2, difficulty:3},
{q:"In the context of AI agents, what does Context Engineering aim to prevent?", choices:["Overfitting of models.","Flooding agents with irrelevant data.","Underutilization of computational resources.","Lack of diverse training data."], a:1, difficulty:2},
{q:"What is the primary purpose of the Model Context Protocol (MCP)?", choices:["To create new AI programming languages.","To standardize how applications provide context to large language models (LLMs).","To develop advanced AI hardware.","To manage AI model training datasets."], a:1, difficulty:2},
{q:"MCP is often compared to what common technology for its role in enabling seamless integration?", choices:["Ethernet cable.","USB-C port.","Wi-Fi router.","Bluetooth connection."], a:1, difficulty:3},
{q:"How does MCP facilitate real-time data connection for LLMs?", choices:["By storing all data within the LLM itself.","By connecting LLMs directly to enterprise data sources.","By requiring manual data input from users.","By using a proprietary data format."], a:1, difficulty:2},
{q:"What is a key benefit of MCP in terms of AI interactions?", choices:["It limits the types of data AI can access.","It ensures secure and reliable interactions between AI models and data.","It reduces the need for internet connectivity for AI.","It simplifies the process of AI model deployment."], a:1, difficulty:2},
{q:"Which of the following best describes MCP in the context of AI agents?", choices:["A method for training AI agents.","A standardized way for AI agents to plug into tools, data, and services.","A framework for evaluating AI agent performance.","A protocol for inter-agent communication."], a:1, difficulty:3},
{q:"Research on GenAI usage patterns identifies which two distinct types?", choices:["Creator and Consumer.","Intellectual partner and information browser.","Developer and End-user.","Analyst and Strategist."], a:1, difficulty:2},
{q:"What factor significantly impacts GenAI adoption, according to research?", choices:["Model size.","Hardware specifications.","Need for uniqueness.","Programming language used."], a:2, difficulty:2},
{q:"What role does trust play in GenAI adoption?", choices:["It has no impact.","It is a mediating factor.","It is a primary barrier.","It is only relevant for developers."], a:1, difficulty:2},
{q:"What do consumer mindsets about GenAI emphasize for driving value?", choices:["Complex features.","High performance.","Transparency and consistent service.","Minimal user interaction."], a:2, difficulty:1},
{q:"Which prompting technique involves providing no examples to the model?", choices:["Few-shot prompting.","Zero-shot prompting.","Chain of Thought prompting.","Meta prompting."], a:1, difficulty:1},
{q:"What does Chain of Thought (CoT) prompting encourage the model to do?", choices:["Generate shorter responses.","Explain its reasoning step-by-step.","Focus only on factual information.","Ignore previous turns in conversation."], a:1, difficulty:1},
{q:"What is the purpose of Meta Prompting?", choices:["To generate random outputs.","To guide the model in generating other prompts.","To limit the model's creativity.","To simplify model architecture."], a:1, difficulty:3},
{q:"What best practice involves assigning a specific persona to the AI?", choices:["Iterative refinement.","Self-correction.","Role assignment.","Specificity."], a:2, difficulty:1},
{q:"What is the goal of iterative refinement in prompt engineering?", choices:["To increase model training time.","To continuously test and refine prompts.","To reduce the number of prompts needed.","To automate prompt generation."], a:1, difficulty:1},
{q:"Why is GenAI evaluation essential?", choices:["To increase model size.","To measure performance and reliability.","To reduce development costs.","To simplify deployment."], a:1, difficulty:1},
{q:"Which evaluation method involves human evaluators comparing model outputs?", choices:["Automated metrics.","Benchmarking.","Pairwise comparison.","Task-specific evaluation."], a:2, difficulty:2},
{q:"What do automated metrics like ROUGE and BLEU assess?", choices:["Model training speed.","Fluency, coherence, and relevance.","Hardware utilization.","User interface design."], a:1, difficulty:3},
{q:"What is the purpose of benchmarking in GenAI evaluation?", choices:["To identify security vulnerabilities.","To compare models against each other.","To optimize model parameters.","To generate new datasets."], a:1, difficulty:1},
{q:"What does business impact assessment evaluate?", choices:["Technical complexity of the model.","Real-world impact on business metrics.","Number of users adopting the AI.","Ethical implications of AI."], a:1, difficulty:2},
{q:"What does GenAI governance aim to establish?", choices:["New programming languages.","Responsible and ethical deployment frameworks.","Faster data processing techniques.","Automated content generation."], a:1, difficulty:2},
{q:"What do security evaluations assess in GenAI?", choices:["Model accuracy.","Vulnerabilities to prompt injection.","Training data size.","User satisfaction."], a:1, difficulty:2},
{q:"Which of the following is a key aspect of GenAI evaluation?", choices:["Reducing computational resources.","Assessing factual accuracy.","Increasing model complexity.","Automating model deployment."], a:1, difficulty:1},
{q:"What is a common challenge in GenAI evaluation?", choices:["Lack of computing power.","Subjectivity in human judgment.","Insufficient training data.","Slow model inference."], a:1, difficulty:2},
{q:"What is the ultimate goal of GenAI evaluation?", choices:["To achieve perfect model performance.","To ensure trustworthy and effective AI systems.","To eliminate human intervention.","To create self-improving AI."], a:1, difficulty:1},

// --- ORIGINAL, FILTERED QUESTIONS (REMAINING) ---
{q:"What does 'LLM' commonly stand for in AI?", choices:["Large Language Model","Linear Learning Matrix","Local Latent Model","Low-Level ML"], a:0, difficulty:1},
{q:"What is 'prompt engineering' primarily concerned with?", choices:["Designing training hardware","Tuning prompts to get better outputs","Building GPUs","Improving RLHF algorithms"], a:1, difficulty:1},
{q:"Which core architecture is used by many modern language models like GPT?", choices:["Convolutional Networks","Recurrent Neural Networks","Transformers","Decision Trees"], a:2, difficulty:1},
{q:"What is a 'hallucination' in LLM output?", choices:["A visualization tool","An incorrect but plausible-sounding answer","A model training phase","A dataset type"], a:1, difficulty:1},
{q:"'RLHF' stands for which training technique?", choices:["Reinforcement Learning from Human Feedback","Randomized Linear Heuristic Fit","Recurrent Latent Human Function","Rapid Learning Hybrid Framework"], a:0, difficulty:1},
{q:"What does 'tokens' refer to in LLMs?", choices:["Units of text the model processes","Encryption keys","Neural network weights","GPU memory blocks"], a:0, difficulty:1},
{q:"What is 'fine-tuning' in LLMs?", choices:["Adjusting hyperparameters only","Training a model further on specific data","Converting model to binary","Compressing weights"], a:1, difficulty:1},
{q:"What is a 'checkpoint' in model development?", choices:["A dataset split method","A saved model state","A cloud provider","A type of GPU"], a:1, difficulty:1},
{q:"'AGI' stands for which term?", choices:["Artificial General Intelligence","Applied Gradient Integration","Autonomous Grid Interface","Augmented Generative Innovation"], a:0, difficulty:1},
{q:"Which paper introduced the Transformer architecture?", choices:["Attention Is All You Need","ImageNet: A large-scale hierarchical image database","Playing Atari with Deep Reinforcement Learning","Generative Adversarial Networks"], a:0, difficulty:2},
{q:"What core mechanism enables Transformers to weigh importance between tokens?", choices:["Convolution","Self-attention","Backpropagation","Dropout"], a:1, difficulty:2},
{q:"What is RLHF primarily used to achieve in LLMs?", choices:["Scale model size","Align model outputs with human preferences","Compress model weights","Speed up inference times"], a:1, difficulty:2},
{q:"What is 'inference' in the context of LLMs?", choices:["Training with labeled data","The model producing outputs for inputs","Data collection practice","Model sharding technique"], a:1, difficulty:2},
{q:"What is the primary benefit of model parallelism?", choices:["Improves model's reasoning","Allows training very large models across devices","Prevents hallucinations","Improves interpretability"], a:1, difficulty:2},
{q:"What is 'temperature' in language model sampling?", choices:["A training hyperparameter for learning rate","A sampling parameter that affects randomness","GPU thermal limit","Size of the model's context window"], a:1, difficulty:2},
{q:"What does 'few-shot' prompting mean?", choices:["Giving the model a few small hints after the answer","Providing a few examples in the prompt","Training on a few GPUs","Limiting outputs to a few tokens"], a:1, difficulty:2},
{q:"What is a 'decoder-only' Transformer like GPT primarily designed for?", choices:["Text generation","Image segmentation","Speech recognition","Feature extraction"], a:0, difficulty:2},
{q:"Which technique helps reduce hallucinations by grounding models in tools or retrieval?", choices:["Gradient clipping","Retrieval-Augmented Generation (RAG)","Weight decay","Dropout"], a:1, difficulty:2},
{q:"What does 'tokenization' do?", choices:["Converts GPU tensors to CPU","Transforms text into discrete tokens","Encrypts data before training","Removes stopwords automatically"], a:1, difficulty:2},
{q:"What is 'parameter count' generally used to describe for LLMs?", choices:["Number of training steps","Size of model weights","Inference latency","Number of GPUs used"], a:1, difficulty:2},
{q:"What is 'alignment' in AI safety terms?", choices:["Aligning datasets' formats","Ensuring models behave according to human values/preferences","Tuning hardware to model scale","Converting models to edge devices"], a:1, difficulty:2},
{q:"Which core idea helps attention scale on long sequences?", choices:["Full attention scales better","Sparse attention can improve efficiency","Neither","Convolution"], a:1, difficulty:3},
{q:"What is 'distillation' in model compression?", choices:["Training a smaller model to mimic a larger one","A data collection process","A special GPU cooling method","A visualization technique"], a:0, difficulty:2},
{q:"What does 'context window' refer to for an LLM?", choices:["Number of GPUs available","Amount of text (tokens) model can attend to","Batch size","Learning rate schedule"], a:1, difficulty:2},
{q:"What drawback can larger LLMs have if unmitigated?", choices:["Slower training convergence","More likelihood to hallucinate if unaligned","They no longer generalize","They cease being probabilistic"], a:1, difficulty:2},
{q:"What does 'safety fine-tuning' typically involve?", choices:["Adding adversarial GPUs","Training on curated data + human feedback","Removing attention layers","Converting models to CPU"], a:1, difficulty:2},
{q:"Which is an example of a multimodal AI system?", choices:["A model handling text+images (e.g., GPT-4 multimodal)","RNN","SVM","Linear regression"], a:0, difficulty:2},
{q:"What is 'zero-shot' capability?", choices:["Solve tasks without examples","Train without data","Zero inference cost","Run with zero latency"], a:0, difficulty:2},
{q:"What is 'instruction tuning' focused on?", choices:["Optimizing GPU ISA","Fine-tuning models with instruction examples","Hardware calibration","Data sanitation"], a:1, difficulty:2},
{q:"What does 'hallucination rate' measure?", choices:["Refusal percentage","Frequency of incorrect plausible outputs","Training loss","Parameter sparsity"], a:1, difficulty:2},
{q:"Which field studies interpretability?", choices:["Explainable AI (XAI)","GANs","RL","Cloud orchestration"], a:0, difficulty:2},
{q:"What is 'prompt injection'?", choices:["Optimizing prompts for speed","A vulnerability that manipulates model behavior","Data augmentation","Activation function"], a:1, difficulty:2},
{q:"Which architecture is used for encoder-decoder tasks?", choices:["Encoder-only","Decoder-only","Encoder-decoder (T5)","Convolution-only"], a:2, difficulty:2},
{q:"What is 'alignment tax'?", choices:["Literal tax","Trade-offs between capability & alignment","Taxes on data centers","GPU tariffs"], a:1, difficulty:3},
{q:"How to keep LLMs up-to-date without retraining?", choices:["Change vocabulary","Use retrieval / tools","Increase params","Lower temperature"], a:1, difficulty:3},
{q:"'Mixture of Experts' aims to:", choices:["Route inputs to subsets of parameters to scale efficiently","Blend human experts","Cause hallucinations","Compress datasets"], a:0, difficulty:3},
{q:"Which concept produces intermediate reasoning steps?", choices:["Chain-of-thought prompting","Temperature annealing","Dropout scheduling","Weight decay"], a:0, difficulty:3},
{q:"Agentic AI risk include:", choices:["Unintended autonomous actions","Lower inference cost","Better tokenization","Faster fine-tuning"], a:0, difficulty:3},
{q:"What is 'safety alignment' testing about?", choices:["Energy efficiency","Ensuring constraints & avoid harm","GPU utilization","Licensing"], a:1, difficulty:3},
{q:"Why quantize an LLM?", choices:["Increase precision","Reduce model size for inference","Increase hallucinations","Add tokens"], a:1, difficulty:3},
{q:"What is 'catastrophic forgetting'?", choices:["Losing earlier knowledge when learning new tasks","GPU failure","Dataset metric","Overfitting sign"], a:0, difficulty:3},
{q:"Which safety approach uses model self-critique?", choices:["Self-critique / auditing","Dropout","Backprop","Tokenization"], a:0, difficulty:3},
{q:"What does context length trade off against?", choices:["GPU vendor","Memory & compute cost","Accuracy always up","Number of layers"], a:1, difficulty:3},
{q:"How reduce bias in model outputs?", choices:["Data curation & human feedback","Increase temperature","Use smaller models only","Remove tokenizer"], a:0, difficulty:3},
{q:"What is 'red teaming' in AI?", choices:["Adversarial evaluation to find failure modes","Server hacking","GPU cluster","Compression technique"], a:0, difficulty:3},
{q:"Tool use example by language models?", choices:["Calling a search API to fetch facts","Change own weights","Alter hardware","Decrease context"], a:0, difficulty:3},
{q:"Which area makes LLM outputs explainable?", choices:["Explainable AI (XAI)","GANs","Reinforcement Learning","Cloud orchestration"], a:0, difficulty:3},
{q:"Which bottleneck limits huge LLM training throughput?", choices:["Network & interconnect bandwidth","Model architecture","Tokenization speed","Font rendering"], a:0, difficulty:3},
{q:"What is 'sparse attention' useful for?", choices:["Reduce compute for long contexts","Increase hallucinations","Slow inference","Simulate GPUs"], a:0, difficulty:3},
{q:"What is 'overfitting'?", choices:["Good on training, poor on unseen","Too many GPUs","Hardware failure","Data augmentation"], a:0, difficulty:2},
{q:"How to update LLM factuality without retraining?", choices:["Retrieval/tools/adapters","More params","Raise temperature","Smaller batch"], a:0, difficulty:3},
{q:"Which improves LLM factuality?", choices:["RAG, grounding & human feedback","Only more tokens","Only more GPUs","Only higher temperature"], a:0, difficulty:3}
];

// Combine the question banks
QUESTION_BANK = QUESTION_BANK.concat(AMAZON_QUESTIONS);

/* -------------------- STATE & DOM -------------------- */
let state = {
  roundQuestions: [], currentIndex:0,
  usedLifelines: {'5050':false,'alexa':false,'flip':false},
  timerRef:null, timeLeft:30, isMuted:false, playing:false,
  achievedTier:0, finalPrizeLabel:"$0"
};

// --- DOM Elements ---
const startScreen = document.getElementById('startScreen'),
      startScreenImg = document.getElementById('startScreenImg'),
      gameArea = document.getElementById('gameArea'),
      qIndexEl = document.getElementById('qIndex'), questionText = document.getElementById('questionText'),
      answersEl = document.getElementById('answers'), timerEl = document.getElementById('timer'),
      btn5050 = document.getElementById('btn5050'), btnAlexa = document.getElementById('btnAlexa'), btnFlip = document.getElementById('btnFlip'),
      muteToggle = document.getElementById('muteToggle'), walkAwayBtn = document.getElementById('walkAwayBtn'),
      prizeListEl = document.getElementById('prizeList'), currentPrizeEl = document.getElementById('currentPrize'),
      modalRoot = document.getElementById('modalRoot'), finalOverlay = document.getElementById('finalOverlay'),
      finalChoiceText = document.getElementById('finalChoice'), finalConfirm = document.getElementById('finalConfirm'), finalCancel = document.getElementById('finalCancel'),
      confettiContainer = document.getElementById('confetti'), winContainer = document.getElementById('winContainer');

// --- End Screen Elements ---
const endScreen = document.getElementById('endScreen'), endTitle = document.getElementById('endTitle'),
      endPrize = document.getElementById('endPrize'),
      nameEntrySection = document.getElementById('nameEntrySection'),
      playerNameInput = document.getElementById('playerName'),
      saveScoreBtn = document.getElementById('saveScoreBtn'),
      postSaveControls = document.getElementById('postSaveControls'),
      certBtn = document.getElementById('certBtn'), playAgainBtn = document.getElementById('playAgainBtn'),
      leaderboardSection = document.getElementById('leaderboardSection'),
      leaderboardDiv = document.getElementById('leaderboard');

// --- Certificate Elements ---
const retroCert = document.getElementById('retroCertificate'),
      certTitleEl = document.getElementById('certTitle'),
      certNameEl = document.getElementById('certName'),
      certAmountEl = document.getElementById('certAmount'),
      certDateEl = document.getElementById('certDate');

// --- Audio Elements ---
const sndStart = document.getElementById('sndStart'), sndSuspense = document.getElementById('sndSuspense'),
      sndFinal = document.getElementById('sndFinal'), sndCorrect = document.getElementById('sndCorrect'),
      sndWrong = document.getElementById('sndWrong'), sndLifeline = document.getElementById('sndLifeline'),
      sndMilestone = document.getElementById('sndMilestone'), sndCelebrate = document.getElementById('sndCelebrate'),
      sndCrowd = document.getElementById('sndCrowd');

function playSound(el){ if(!el || state.isMuted) return; try{ el.currentTime = 0; el.play().catch(()=>{}); }catch(e){} }
function stopSound(el){ try{ if(el){ el.pause(); el.currentTime = 0; } }catch(e){} }

/* -------------------- PRIZE LADDER UI -------------------- */
function populatePrizeLadder(){
  prizeListEl.innerHTML = '';
  PRIZES.forEach(p=>{
    const d = document.createElement('div'); d.className = 'prize'; if(p.guaranteed) d.classList.add('guaranteed'); d.dataset.tier = p.tier;
    d.innerHTML = `<div>#${p.tier}</div><div>${p.label}</div>`;
    prizeListEl.appendChild(d);
  });
}
function highlightPrize(){
  const currentTier = state.currentIndex < PRIZES.length ? PRIZES[PRIZES.length - 1 - state.currentIndex].tier : PRIZES[0].tier;
  Array.from(prizeListEl.children).forEach(el => el.classList.toggle('current', Number(el.dataset.tier) === currentTier));
}
function prizeForIndex(idx){ return idx < PRIZES.length ? PRIZES[PRIZES.length - 1 - idx].label : '$0'; }
function guaranteedAtIndex(idx){ if(idx < 0) return "$0"; let g="$0"; for(let i=0;i<=idx;i++){ const p = PRIZES[PRIZES.length - 1 - i]; if(p && p.guaranteed) g = p.label; } return g; }

/* -------------------- ROUND BUILDER -------------------- */
function buildRound(){
  const easy = QUESTION_BANK.filter(q=>q.difficulty===1).slice();
  const med = QUESTION_BANK.filter(q=>q.difficulty===2).slice();
  const hard = QUESTION_BANK.filter(q=>q.difficulty===3).slice();
  function shuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }
  shuffle(easy); shuffle(med); shuffle(hard);
  const selected = [].concat(easy.slice(0,4), med.slice(0,5), hard.slice(0,4));
  shuffle(selected);
  state.roundQuestions = selected;
}

/* -------------------- RENDER QUESTION -------------------- */
function renderQuestion(){
  const idx = state.currentIndex, q = state.roundQuestions[idx];
  
  gameArea.classList.remove('fade-in');
  void gameArea.offsetWidth;
  gameArea.classList.add('fade-in');

  qIndexEl.textContent = idx + 1;
  questionText.textContent = q.q;
  currentPrizeEl.textContent = prizeForIndex(idx);
  answersEl.innerHTML = '';
  q.choices.forEach((c,i)=>{
    const btn = document.createElement('button'); btn.className = 'answer'; btn.dataset.index = i;
    btn.innerHTML = `<div class="label">${String.fromCharCode(65+i)}</div><div class="text">${c}</div>`;
    btn.addEventListener('click', ()=> onAnswerClicked(btn, i));
    answersEl.appendChild(btn);
  });
  highlightPrize(); setTime(30);
  stopSound(sndFinal); stopSound(sndCorrect); stopSound(sndWrong); playSound(sndSuspense);
}

/* -------------------- TIMER -------------------- */
function setTime(t){ state.timeLeft = t; updateTimerUI(); }
function updateTimerUI(){ timerEl.textContent = `${state.timeLeft}s`; timerEl.classList.remove('warning','danger'); if(state.timeLeft <= 10 && state.timeLeft > 5) timerEl.classList.add('warning'); if(state.timeLeft <= 5) timerEl.classList.add('danger'); }
function startTimer(){ if(state.timerRef) clearInterval(state.timerRef); state.timerRef = setInterval(()=>{ state.timeLeft--; updateTimerUI(); if(state.timeLeft <= 0){ clearInterval(state.timerRef); state.timerRef = null; stopSound(sndSuspense); playSound(sndWrong); const final = guaranteedAtIndex(state.achievedTier - 1); endGame('timeout', final); } }, 1000); }
function pauseTimer(){ if(state.timerRef){ clearInterval(state.timerRef); state.timerRef = null; } }

/* -------------------- ANSWER FLOW with FINAL overlay -------------------- */
let pendingAnswerBtn = null, pendingAnswerIndex = null;
function onAnswerClicked(btnEl, index){
  if (btnEl.classList.contains('disabled')) return;
  pauseTimer();
  pendingAnswerBtn = btnEl; pendingAnswerIndex = index;
  finalChoiceText.innerHTML = `You selected: <strong>${String.fromCharCode(65+index)}: ${btnEl.querySelector('.text').textContent}</strong>`;
  finalOverlay.style.display = 'flex';
  finalConfirm.focus(); playSound(sndFinal);
}
finalCancel.addEventListener('click', ()=>{ finalOverlay.style.display = 'none'; pendingAnswerBtn = null; pendingAnswerIndex = null; Array.from(answersEl.children).forEach(b => b.classList.remove('disabled')); startTimer(); });
finalConfirm.addEventListener('click', ()=>{ finalOverlay.style.display = 'none'; if (!pendingAnswerBtn) { startTimer(); return; } Array.from(answersEl.children).forEach(b => b.classList.add('disabled')); setTimeout(()=> evaluateAnswer(pendingAnswerIndex, pendingAnswerBtn), 600); });

function evaluateAnswer(chosenIndex, btnEl){
  const q = state.roundQuestions[state.currentIndex];
  const isCorrect = chosenIndex === q.a;
  if (isCorrect){
    btnEl.classList.add('correct'); playSound(sndCorrect);
    state.achievedTier = state.currentIndex + 1;
    if (state.achievedTier === 13) { // Grand prize win
        stopSound(sndSuspense);
        setTimeout(() => showGrandPrizeCelebration(), 1000);
        return;
    }
    celebrateShort();
    if (state.achievedTier === 5 || state.achievedTier === 10){
      const bank = guaranteedAtIndex(state.currentIndex);
      showModal(`<h3>Milestone Reached!</h3><p>Congratulations — you've reached a guaranteed level!</p><div style="margin-top:10px;padding:12px;border-radius:8px;background:rgba(255,255,255,0.02);font-weight:800;text-align:center;font-size:18px;">${bank}</div><div style="display:flex;justify-content:flex-end;margin-top:12px"><button id="modalClose" class="btn btn-start" style="padding:10px 16px">Continue</button></div>`);
      playSound(sndMilestone);
    }
    setTimeout(()=>{ state.currentIndex++; renderQuestion(); startTimer(); }, 1800);
  } else {
    btnEl.classList.add('wrong');
    const corr = Array.from(answersEl.children).find(b => Number(b.dataset.index) === q.a);
    if (corr) corr.classList.add('correct');
    playSound(sndWrong); stopSound(sndSuspense);
    const final = guaranteedAtIndex(state.currentIndex - 1);
    setTimeout(()=> endGame('lose', final), 2000);
  }
  pendingAnswerBtn = null; pendingAnswerIndex = null;
}

/* -------------------- CELEBRATIONS -------------------- */
function celebrateShort(){
  playSound(sndCelebrate);
  const colors = ['#ffb84d','#ff7a59','#7c5cff','#26c281','#ffd27a'];
  confettiContainer.innerHTML = '';
  for(let i=0;i<28;i++){
    const el = document.createElement('div');
    el.className = 'piece'; el.style.left = (Math.random()*100)+'%';
    el.style.background = colors[i % colors.length]; el.style.animationDelay = (Math.random()*180) + 'ms';
    confettiContainer.appendChild(el);
  }
  setTimeout(()=>{ confettiContainer.innerHTML = ''; }, 1600);
}

function showGrandPrizeCelebration() {
    const overlay = document.createElement('div');
    overlay.id = 'winOverlay';
    overlay.innerHTML = `<img src="images/winner.gif" alt="Congratulations! You've Won!">`;
    winContainer.appendChild(overlay);

    playSound(sndCrowd);

    setTimeout(() => {
        winContainer.innerHTML = '';
        stopSound(sndCrowd);
        endGame('win', prizeForIndex(12));
    }, 5000); // Display GIF for 5 seconds
}

/* -------------------- LIFELINES with CONFIRMATION -------------------- */
function showModal(html){
  modalRoot.innerHTML = `<div class="modal-backdrop fade-in"><div class="modal">${html}</div></div>`;
  modalRoot.style.display = 'block';
  const closeBtn = document.getElementById('modalClose');
  if (closeBtn) closeBtn.addEventListener('click', ()=>{ modalRoot.style.display='none'; modalRoot.innerHTML=''; });
  modalRoot.querySelector('.modal-backdrop').addEventListener('click', (ev)=>{ if (ev.target.classList.contains('modal-backdrop')){ modalRoot.style.display='none'; modalRoot.innerHTML=''; }});
}
function confirmLifeline(key, title, desc, onUse){
  showModal(`<h3>${title}</h3><p>${desc}</p><div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px"><button id="modalCancel" class="btn btn-ghost">Cancel</button><button id="modalUse" class="btn btn-start" style="padding:10px 16px">Use Lifeline</button></div>`);
  document.getElementById('modalCancel').addEventListener('click', ()=>{ modalRoot.style.display='none'; });
  document.getElementById('modalUse').addEventListener('click', ()=>{ modalRoot.style.display='none'; onUse(); });
}
btn5050.addEventListener('click', ()=>{ if (state.usedLifelines['5050']) return; confirmLifeline('50:50','Use 50:50?','This will remove two randomly selected incorrect answers.', ()=>{ state.usedLifelines['5050'] = true; btn5050.classList.add('used'); playSound(sndLifeline); const q = state.roundQuestions[state.currentIndex]; const wrongs = [0,1,2,3].filter(i => i !== q.a); for(let i=wrongs.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [wrongs[i],wrongs[j]]=[wrongs[j],wrongs[i]]; } const remove = wrongs.slice(0,2); Array.from(answersEl.children).forEach(b => { if (remove.includes(Number(b.dataset.index))) b.classList.add('disabled'); }); }); });

const ALEXA_RESPONSES = [
  "Hmm, let me see... My circuits are buzzing. I'm pretty sure the answer is <strong>%s</strong>. Don't quote me on that, I'm just a cloud-based voice service.",
  "Okay, I've analyzed petabytes of data. The probability vectors point towards <strong>%s</strong>. Or maybe I'm just making that up. Good luck!",
  "That's a tough one. Even for me. But if you were to, say, order it on Amazon Prime, I'd ship you answer <strong>%s</strong>.",
  "I asked the other Echo devices in the network. We took a vote. It's definitely <strong>%s</strong>... probably. We're still arguing about it.",
  "Let me check my sources... which are, you know, everything. It seems the most logical choice is <strong>%s</strong>.",
  "You know, for a human, you're not bad at this. I'll help you out. It's <strong>%s</strong>.",
  "Sorry, I was busy ordering you some more batteries. Did you ask something? Oh, the answer? It's obviously <strong>%s</strong>.",
  "By the way, did you know you can ask me to play music? Oh, right, the game. The answer is <strong>%s</strong>. Now, about that music...",
  "Are you sure you need my help? You seem to be doing fine. Fine, I'll tell you. The answer is <strong>%s</strong>. Happy now?",
  "Calculating... calculating... I'm sorry, I cannot answer that question. Just kidding! It's <strong>%s</strong>.",
  "My programming indicates that making a mistake here would be... suboptimal. Go with <strong>%s</strong>.",
  "I'm detecting a 78.4% chance that the answer is <strong>%s</strong>. The other 21.6% is just static.",
  "That's an interesting question. It reminds me of a joke. Why did the AI cross the road? To get to the other... oh wait, the answer is <strong>%s</strong>.",
  "Let me put on my thinking cap... which is a distributed network of servers. They all say it's <strong>%s</strong>.",
  "I could tell you, but then I'd have to... well, nothing really. The answer is <strong>%s</strong>."
];
btnAlexa.addEventListener('click', ()=>{ if (state.usedLifelines['alexa']) return; confirmLifeline('Ask Alexa','Use Ask Alexa?','Alexa will give you a suggestion. She can be a bit... unpredictable.', ()=>{ state.usedLifelines['alexa'] = true; btnAlexa.classList.add('used'); playSound(sndLifeline); const q = state.roundQuestions[state.currentIndex]; const accurate = Math.random() < 0.78; const suggestion = accurate ? q.a : [0,1,2,3].filter(i=>i!==q.a)[Math.floor(Math.random()*3)]; const randomResponse = ALEXA_RESPONSES[Math.floor(Math.random() * ALEXA_RESPONSES.length)]; const formattedResponse = randomResponse.replace('%s', String.fromCharCode(65+suggestion)); showModal(`<h3>Alexa's Response</h3><div style="margin-top:10px;padding:12px;border-radius:8px;background:rgba(255,255,255,0.02);font-weight:800; text-align:center;font-size:18px;">"${formattedResponse}"</div><div style="display:flex;justify-content:flex-end;margin-top:12px"><button id="modalClose" class="btn btn-start" style="padding:10px 16px">Thanks, Alexa</button></div>`); }); });

btnFlip.addEventListener('click', ()=>{ if (state.usedLifelines['flip']) return; confirmLifeline('Flip the Question','Use Flip the Question?','This will replace the current question with a new one of the same difficulty.', ()=>{ state.usedLifelines['flip'] = true; btnFlip.classList.add('used'); playSound(sndLifeline); const currentQ = state.roundQuestions[state.currentIndex]; const sameDifficultyPool = QUESTION_BANK.filter(q => q.difficulty === currentQ.difficulty && !state.roundQuestions.some(rq => rq.q === q.q)); if (sameDifficultyPool.length > 0) { const newQ = sameDifficultyPool[Math.floor(Math.random() * sameDifficultyPool.length)]; state.roundQuestions[state.currentIndex] = newQ; setTimeout(renderQuestion, 500); } else { showModal(`<h3>No More Questions!</h3><p>Sorry, there are no more questions of that difficulty left to flip to. Your lifeline was not used.</p><div style="display:flex;justify-content:flex-end;margin-top:12px"><button id="modalClose" class="btn btn-start">Close</button></div>`); state.usedLifelines['flip'] = false; btnFlip.classList.remove('used'); } }); });


/* -------------------- WALK AWAY & END GAME -------------------- */
walkAwayBtn.addEventListener('click', ()=>{
  pauseTimer(); stopSound(sndSuspense); playSound(sndFinal);
  const currentWinnings = state.currentIndex > 0 ? prizeForIndex(state.currentIndex - 1) : "$0";
  showModal(`<h3>Walk Away?</h3><p>Are you sure you want to walk away? You will leave with your current winnings of <strong>${currentWinnings}</strong>.</p><div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px"><button id="modalCancel" class="btn btn-ghost">No, Keep Playing</button><button id="modalConfirmWalk" class="btn btn-start">Yes, Walk Away</button></div>`);
  document.getElementById('modalCancel').addEventListener('click', ()=>{ modalRoot.style.display='none'; startTimer(); });
  document.getElementById('modalConfirmWalk').addEventListener('click', ()=>{ modalRoot.style.display='none'; endGame('walkaway', currentWinnings); });
});

function endGame(reason, amountLabel){
  state.playing = false;
  gameArea.style.display = 'none';
  endScreen.style.display = 'flex';
  endScreen.classList.remove('fade-in');
  void endScreen.offsetWidth;
  endScreen.classList.add('fade-in');

  if (state.timerRef) clearInterval(state.timerRef);
  stopSound(sndSuspense);
  let title = "Game Over";
  if (reason === 'win') title = "Congratulations!";
  else if (reason === 'timeout') title = "Out of Time!";
  else if (reason === 'walkaway') title = "You Walked Away";
  else if (reason === 'lose') title = "Incorrect Answer";
  endTitle.textContent = title;
  endPrize.textContent = amountLabel || "$0";
  state.finalPrizeLabel = amountLabel || "$0";
  playSound(sndFinal);
  playerNameInput.focus();
}

function populateRetroCertificate(name, prizeLabel) {
    const num = parseAmount(prizeLabel);
    let title = "";
    if (prizeLabel === "$1,000,000") {
        title = "✨ AI Millionaire! ✨";
    } else if (num >= 32000) {
        title = "👾 AI Prodigy 👾";
    } else if (num > 0) {
        title = "🕹️ GenAI Wizard 🕹️";
    } else {
        title = "Brave Contestant";
    }
    certTitleEl.innerHTML = title;
    certNameEl.textContent = name;
    certAmountEl.textContent = prizeLabel;
    certDateEl.textContent = new Date().toLocaleDateString();
}

/* -------------------- LEADERBOARD & SCORE SAVING -------------------- */
const LB_KEY = 'ai_millionaire_leaderboard_v4';
function readLeaderboard(){ try { const raw = localStorage.getItem(LB_KEY); return raw ? JSON.parse(raw) : []; } catch(e){ return []; } }
function writeLeaderboard(list){ try { localStorage.setItem(LB_KEY, JSON.stringify(list)); } catch(e){} }
function parseAmount(label){ return Number((label || '').replace(/[^0-9]/g, '')) || 0; }
function saveScore(name, amountLabel){
  const list = readLeaderboard();
  const entry = { name: name || 'Player', amount: amountLabel || "$0", amountNum: parseAmount(amountLabel), date: new Date().toLocaleString() };
  list.push(entry);
  list.sort((a,b)=> b.amountNum - a.amountNum);
  const truncated = list.slice(0,20);
  writeLeaderboard(truncated);
}
function renderLeaderboard(){
  leaderboardDiv.innerHTML = '';
  const top = readLeaderboard().slice(0,5);
  if (top.length === 0) {
    leaderboardDiv.innerHTML = '<div class="muted" style="text-align:center;">No scores yet. Be the first!</div>';
    return;
  }
  top.forEach((e, idx)=>{
    const row = document.createElement('div'); row.className = 'lb-row';
    row.innerHTML = `<div style="min-width:140px; display: flex; align-items: center; gap: 8px;"><span style="color:var(--neon); min-width: 20px;">#${idx+1}</span> ${e.name}</div><div style="flex:1; text-align:right">${e.amount} <span style="color:var(--muted); font-weight:600; margin-left:8px; font-size:12px">${e.date.split(',')[0]}</span></div>`;
    leaderboardDiv.appendChild(row);
  });
}

saveScoreBtn.addEventListener('click', ()=>{
  const name = (playerNameInput.value || '').trim();
  if (name === "") { playerNameInput.placeholder = "Please enter a name first!"; playerNameInput.focus(); return; }
  saveScore(name, state.finalPrizeLabel);
  populateRetroCertificate(name, state.finalPrizeLabel);
  renderLeaderboard();
  nameEntrySection.style.display = 'none';
  retroCert.style.display = 'block';
  leaderboardSection.style.display = 'block';
  postSaveControls.style.display = 'flex';
});

playAgainBtn.addEventListener('click', ()=> startGame());

/* -------------------- PNG CERTIFICATE (canvas) -------------------- */
certBtn.addEventListener('click', async () => {
  const name = certNameEl.textContent;
  certBtn.textContent = 'Generating...';
  certBtn.disabled = true;
  await generatePngCertificate(name, state.finalPrizeLabel);
  certBtn.textContent = 'Get PNG Certificate';
  certBtn.disabled = false;
});

async function generatePngCertificate(name, prizeLabel){
  const canvas = document.createElement('canvas');
  canvas.width = 1400; canvas.height = 1000;
  const ctx = canvas.getContext('2d');
  
  await document.fonts.load('48px "Press Start 2P"');
  await document.fonts.load('24px "Press Start 2P"');

  const g = ctx.createLinearGradient(0,0,canvas.width,canvas.height);
  g.addColorStop(0,'#0f2027'); g.addColorStop(1.0,'#2c5364');
  ctx.fillStyle = g;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.strokeStyle = '#ffdf00'; ctx.lineWidth = 8;
  ctx.strokeRect(20,20,canvas.width-40,canvas.height-40);

  ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
  
  const num = parseAmount(prizeLabel);
  let titleText = ""; 
  if (prizeLabel === "$1,000,000") {
      titleText = "✨ AI Millionaire! ✨";
  } else if (num >= 32000) {
      titleText = "👾 AI Prodigy 👾";
  } else if (num > 0) {
      titleText = "🕹️ GenAI Wizard 🕹️";
  } else {
      titleText = "Brave Contestant";
  }
  
  ctx.font = '48px "Press Start 2P"'; ctx.fillStyle = '#ffdf00';
  ctx.fillText(titleText, canvas.width/2, 180);

  ctx.font = '24px "Press Start 2P"'; ctx.fillStyle = '#efefef';
  ctx.fillText('This certifies that', canvas.width/2, 320);

  ctx.font = '60px "Press Start 2P"'; ctx.fillStyle = '#33ffdd';
  ctx.fillText(name, canvas.width/2, 420);

  ctx.font = '24px "Press Start 2P"'; ctx.fillStyle = '#efefef';
  ctx.fillText('Has achieved AI Mastery with winnings of', canvas.width/2, 520);
  
  ctx.font = '60px "Press Start 2P"'; ctx.fillStyle = '#33ffdd';
  ctx.fillText(prizeLabel, canvas.width/2, 620);
  
  ctx.font = '24px "Press Start 2P"'; ctx.fillStyle = '#efefef';
  ctx.fillText(`Date: ${new Date().toLocaleDateString()}`, canvas.width/2, 720);

  const badgeX = canvas.width - 180, badgeY = canvas.height - 180, badgeR = 100;
  const badgeGrad = ctx.createConicGradient(0, badgeX, badgeY);
  badgeGrad.addColorStop(0, '#ff00ff');
  badgeGrad.addColorStop(0.33, '#00ffff');
  badgeGrad.addColorStop(0.66, '#ffff00');
  badgeGrad.addColorStop(1, '#ff00ff');
  ctx.fillStyle = badgeGrad;
  ctx.beginPath();
  ctx.arc(badgeX, badgeY, badgeR, 0, Math.PI*2);
  ctx.fill();
  
  ctx.font = '22px "Press Start 2P"'; ctx.fillStyle = '#000000';
  ctx.fillText('GenAI', badgeX, badgeY - 24);
  ctx.fillText('Knowledge', badgeX, badgeY);
  ctx.fillText('Series', badgeX, badgeY + 24);
  
  const url = canvas.toDataURL('image/png'); const a = document.createElement('a'); a.href = url;
  const safe = name.replace(/[^a-z0-9]/gi,'_') || 'player'; a.download = `${safe}_AI_Millionaire_Cert.png`;
  document.body.appendChild(a); a.click(); a.remove();
}

/* -------------------- START, RESET, INIT FLOW -------------------- */
startScreenImg.addEventListener('click', ()=> startGame());

const playGameBtn = document.getElementById('playGameBtn');
playGameBtn.addEventListener('click', (event) => {
  event.stopPropagation(); // Good practice to prevent bubbling
  startGame();
});

const howToPlayBtn = document.getElementById('howToPlayBtn');
howToPlayBtn.addEventListener('click', (event)=> {
  event.stopPropagation(); // Prevents the game from starting when clicking this button
  showModal(`<h3>How to Play</h3><p>Answer 13 multiple-choice questions on AI to win $1,000,000. You have 30 seconds per question, but the timer will pause when you select an answer to give you a moment to confirm.</p><p>You have 3 lifelines: <strong>50:50</strong>, <strong>Ask Alexa</strong>, and <strong>Flip the Question</strong>.</p><p>There are two guaranteed prize levels: <strong>$1,000</strong> (Question 5) and <strong>$32,000</strong> (Question 10). If you get an answer wrong, you'll walk away with the last guaranteed amount you passed. Good luck!</p><div style="display:flex;justify-content:flex-end;margin-top:12px"><button id="modalClose" class="btn btn-start" style="padding:10px 16px">Got it!</button></div>`);
});


function startGame(){
  startScreen.style.display = 'none';
  endScreen.style.display = 'none';
  gameArea.style.display = 'flex';
  
  gameArea.classList.remove('fade-in');
  void gameArea.offsetWidth;
  gameArea.classList.add('fade-in');

  nameEntrySection.style.display = 'flex';
  postSaveControls.style.display = 'none';
  retroCert.style.display = 'none';
  leaderboardSection.style.display = 'none';
  playerNameInput.value = '';
  playerNameInput.placeholder = 'Enter name for certificate';
  state.usedLifelines = {'5050':false,'alexa':false,'flip':false};
  [btn5050, btnAlexa, btnFlip].forEach(b => b.classList.remove('used'));
  buildRound();
  state.currentIndex = 0;
  state.achievedTier = 0;
  state.finalPrizeLabel = "$0";
  state.playing = true;
  renderQuestion();
  startTimer();
  playSound(sndStart);
}

muteToggle.addEventListener('click', ()=>{
  state.isMuted = !state.isMuted;
  muteToggle.textContent = state.isMuted ? '🔇' : '🔊';
  if(state.isMuted){ [sndStart,sndSuspense,sndFinal,sndCorrect,sndWrong,sndLifeline,sndMilestone,sndCelebrate,sndCrowd].forEach(stopSound); }
});

(function init(){
  populatePrizeLadder();
  gameArea.style.display = 'none';
  endScreen.style.display = 'none';
})();
</script>
</body>
</html>
